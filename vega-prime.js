// Generated by CoffeeScript 1.7.1
(function() {
  var VegaObservatory, VegaPrime;

  VegaObservatory = require('../vega-observatory');

  VegaPrime = (function() {
    function VegaPrime(options) {
      this.options = options;
      this.observatory = this.options.observatory || new VegaObservatory({
        url: this.options.url,
        roomId: this.options.roomId,
        badge: this.options.badge
      });
      this._setCallbacks();
    }

    VegaPrime.prototype.init = function() {
      return this.observatory.call();
    };

    VegaPrime.prototype.onStreamAdded = function(f) {
      return this.observatory.onStreamAdded(f);
    };

    VegaPrime.prototype._setCallbacks = function() {
      this.observatory.on('callAccepted', (function(_this) {
        return function(peers) {
          return peers.forEach(function(peer) {
            return _this.observatory.createOffer(peer.peerId);
          });
        };
      })(this));
      return this.observatory.on('offer', (function(_this) {
        return function(payload) {
          return _this.observatory.createAnswer(payload.peerId);
        };
      })(this));
    };

    return VegaPrime;

  })();

  module.exports = VegaPrime;

}).call(this);
